<!doctype html>
<html>
<head>
  <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
  <script src="/javascripts/jquery-1.7.2.min.js"></script>
</head>
<body>
  <div class="container">
  <header>
    <h1>Web Intents test</h1>
  </header>
  <section>
    <h2>Video List</h2>
    <dl class="dl-horizontal">
      <dt>
        <img src="images/bunny120.png">
      </dt>
      <dd>
        <h3>Big Buck BUNNY</h3>
        <ul class="unstyled">
          <li><a href="videos/bunny.mp4">このサイトで見る</a></li>
          <li><a href="videos/bunny.mp4" data-name="Big Buck BUNNY" data-thumbnail="images/bunny120.png" class="wi">身の回りのTVで見る（via WebIntents）</a></li>
        </ul>
      </dd>
      <dt>
        <img src="images/manbo.png">
      </dt>
      <dd>
        <h3>マンボウ 寄生虫をつけて泳ぐ（&copy; NHK）</h3>
        <ul class="unstyled">
          <li><a href="videos/manbo.mp4">このサイトで見る</a></li>
          <li><a href="videos/manbo.mp4" data-name="マンボウ寄生虫をつけて泳ぐ" data-thumbnail="images/manbo.png" class="wi">身の回りのTVで見る（via WebIntents）</a></li>
        </ul>
      </dd>
      <dt>
        <img src="images/billiard_daruma.png">
      </dt>
      <dd>
        <h3>ビリヤード だるま落としショット（&copy; NHK）</h3>
        <ul class="unstyled">
          <li><a href="videos/billiard_daruma.mp4">このサイトで見る</a></li>
          <li><a href="videos/billiard_daruma.mp4" data-name="ビリヤードだるま落としショット" data-thumbnail="images/billiard_daruma.png" class="wi">身の回りのTVで見る（via WebIntents）</a></li>
        </ul>
      </dd>
      <dt>
        <img src="images/shabon.png">
      </dt>
      <dd>
        <h3>シャボン玉 イメージショット（&copy; NHK）</h3>
        <ul class="unstyled">
          <li><a href="videos/shabondama.mp4">このサイトで見る</a></li>
          <li><a href="videos/shabondama.mp4" data-name="シャボン玉 イメージショット" data-thumbnail="images/shabon.png" class="wi">身の回りのTVで見る（via WebIntents）</a></li>
        </ul>
      </dd>
    </dl>
   </section>
  </div>



<script>
 if(window.WebKitIntent || window.Intent) {
  window.Intent = window.Intent || window.WebKitIntent;
  window.navigator.startActivity = window.navigator.startActivity || window.navigator.webkitStartActivity;
  window.intent = window.intent || window.webkitIntent;

  $("a.wi").bind("click", function(e){
    var len = location.pathname.split("/").length;
    var name = $(this).data('name')
      , thumbnail_url = location.origin + location.pathname + $(this).data('thumbnail')
      , url = location.origin+location.pathname.split("/").splice(0, len - 1).join("/")+"/"+$(this).attr("href")
      , data = {
        "name" : name,
        "thumbnailUrl" : thumbnail_url,
        "url": url
      }

    var intent = new Intent("http://webintents.org/view", "video/mp4", data);
    window.navigator.startActivity(intent, null, null);

    e.preventDefault();
  });
}
</script>
</body>
</html>
